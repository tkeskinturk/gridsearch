<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Using the gridsearch Package • gridsearch</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using the gridsearch Package">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gridsearch</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/usage.html">Using the gridsearch Package</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tkeskinturk/gridsearch/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Using the gridsearch Package</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tkeskinturk/gridsearch/blob/master/vignettes/usage.Rmd" class="external-link"><code>vignettes/usage.Rmd</code></a></small>
      <div class="d-none name"><code>usage.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="motivation">Motivation<a class="anchor" aria-label="anchor" href="#motivation"></a>
</h2>
<p>Researchers working with panel data often pose three core questions.
Given observed survey trajectories of individual responses in empirical
data,</p>
<ol style="list-style-type: decimal">
<li>How many people changed?</li>
<li>How much they changed?</li>
<li>Who changed within the observed sample?</li>
</ol>
<p>This often involves questions like whether people changed policy
preferences within a specific time-window, or whether a substantive
portion of the respondents moved their positions.</p>
<p>That said, longitudinal change could result from various mechanisms:
large segments of the population may shift their opinions in a specific
direction in small or large amounts; a small segment of the population
may have large changes; or a mix of changes—including positive
<em>and</em> negative movements—may alter the overall balance.</p>
<p>The <code>gridsearch</code> is designed to give researchers a
preliminary check as to what potential data generation processes may
have generated their observed data.</p>
</div>
<div class="section level2">
<h2 id="illustration">Illustration<a class="anchor" aria-label="anchor" href="#illustration"></a>
</h2>
<div class="section level3">
<h3 id="data-generation-processes">Data Generation Processes<a class="anchor" aria-label="anchor" href="#data-generation-processes"></a>
</h3>
<p>Think about a panel study, where we observe 1,000 individuals across
3 time periods. Let us generate one simulated dataframe, where we
<em>know</em> the true data generation process.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1123</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/buildDGP.html">buildDGP</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  t <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  rate <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  balance_dir <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  balance_res <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  strength <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  reliable <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  export <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  patterns <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  slopes <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We generated this data with an underlying data-generation process
(DGP).</p>
<p>We noted that there are 1,000 individuals (<code>n</code>) observed 3
times (<code>t</code>). These individuals have latent positions on a
policy item, let’s call it <code>y_true</code>, that shows a normal
latent distribution:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">y_true</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Latent Position"</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p><img src="usage_files/figure-html/unnamed-chunk-3-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>We also specified that 50% of these 1,000 individuals
(<code>rate</code>) <em>changed</em> their underlying latent positions
within this window with 1 SD (<code>strength</code>) in the positive
direction (<code>balance_dir</code>). This means that, in the aggregate,
there was a change of roughly 0.5 SD in the entire population:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y_true</span> <span class="op">~</span> <span class="va">t</span>, data <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = y_true ~ t, data = d$data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)            t  </span></span>
<span><span class="co">#&gt;    -0.01765      0.47800</span></span></code></pre></div>
<p>Another way to look into this is to randomly pick some individuals
and see their patterns:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span><span class="op">$</span><span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pid</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">1000</span>, size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">t</span>, y <span class="op">=</span> <span class="va">y_true</span>, group <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span> <span class="op">~</span> <span class="va">pid</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="usage_files/figure-html/unnamed-chunk-5-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>Yet, suppose that the survey team asked this question with binary
terms, so respondents have only two options, agree or disagree, when
they answer this question. Suppose also that there are some question
wording and related problems, which make the reliability of this item to
be 80% (<code>reliable</code>). This means that, over a three-wave
period, we have multiple response patterns observed in our empirical
data:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span><span class="op">$</span><span class="va">patterns</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 2</span></span></span>
<span><span class="co">#&gt;   patterns     n</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 000        307</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 001        122</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 010         43</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 011        124</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 100         22</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 101         45</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> 110         36</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> 111        301</span></span></code></pre></div>
<p>How can we answer the three questions we initially posed?</p>
</div>
<div class="section level3">
<h3 id="grid-search-algorithm">Grid Search Algorithm<a class="anchor" aria-label="anchor" href="#grid-search-algorithm"></a>
</h3>
<p>The grid-search algorithm tries to answer this question. It performs
three steps:</p>
<ol style="list-style-type: decimal">
<li><p>It generates a grid of 41 x 40 panels, where there are 41 values
representing the percent of units changing from 0 to 1, and 40 values
representing the strength of change in SD terms, ranging from 0 to 2. It
generates 5 of these panels, where each panel specifies a specific mix
of change trajectories: everyone changing negatively, 75% changing
negatively and 25% changing positively, 50% changing negatively and 50%
changing positively, 25% changing negatively and 75% changing
positively, and everyone changing positively. For each cell, the
procedure generates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
simulated dataset, using these parameter values in its DGP.</p></li>
<li><p>For each simulated dataset, it generates a contingency table (as
presented above) and calculates the summed difference between this
contingency table and the observed empirical table. Here is an example
of this process:</p></li>
</ol>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>1</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtext mathvariant="normal">Observed</mtext></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>869</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>153</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>75</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>115</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>65</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>71</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>54</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>746</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mo>−</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtext mathvariant="normal">Simulated</mtext></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>810</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>75</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>103</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>57</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>188</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>66</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>148</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>701</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mtext mathvariant="normal">Absolute Difference</mtext></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>59</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>78</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>28</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>58</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>123</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>5</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>94</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>45</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">
\begin{bmatrix}
\\
0, 0, 0 \\
0, 0, 1 \\
0, 1, 0 \\
0, 1, 1 \\
1, 0, 0 \\
1, 0, 1 \\
1, 1, 0 \\
1, 1, 1
\end{bmatrix} 
=
\begin{bmatrix}
\text{Observed} \\
869 \\
153 \\
75 \\
115 \\
65 \\
71 \\
54 \\
746 \\
\end{bmatrix}
-
\begin{bmatrix}
\text{Simulated} \\
810 \\
75 \\
103 \\
57 \\
188 \\
66 \\
148 \\
701 \\
\end{bmatrix}
=
\begin{bmatrix}
\text{Absolute Difference} \\
59 \\
78 \\
28 \\
58 \\
123 \\
5 \\
94 \\
45 \\
\end{bmatrix}
</annotation></semantics></math></p>
<ol start="3" style="list-style-type: decimal">
<li>Finally, the algorithm goes through several smoothing stages. In the
contingency table above, the absolute difference equals to 490. This
represents one cell in the grids. The algorithm then smoothes each of
these cells by leveraging information from its neighboring cells, such
that each cell is averaged using 25 cells (24 neighbor cells and
itself). It then estimates a tensor product smooth by fitting a model
that interacts rate of change and strength of change in each panel,
allowing us to have general estimates about how close a cell is to the
observed data generation process.</li>
</ol>
<p>Let’s apply this to our simulated dataset.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gridSearch.html">gridSearch</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">data</span>,</span>
<span>  yname <span class="op">=</span> <span class="st">'y_obs'</span>, <span class="co">## observed binary outcome</span></span>
<span>  tname <span class="op">=</span> <span class="st">'t'</span>, <span class="co">## time variable</span></span>
<span>  pname <span class="op">=</span> <span class="st">'pid'</span>, <span class="co">## panel identifier</span></span>
<span>  steps <span class="op">=</span> <span class="fl">1</span>, <span class="co">## the number of simulated datasets per cell</span></span>
<span>  reliability <span class="op">=</span> <span class="fl">0.8</span>, <span class="co">## assumed reliability score</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; This function drops missing values. Tread carefully.</span></span>
<span><span class="co">#&gt; Warning in checkNumberOfLocalWorkers(workers): Careful, you are setting up 8</span></span>
<span><span class="co">#&gt; localhost parallel workers with only 4 CPU cores available for this R process</span></span>
<span><span class="co">#&gt; (per 'system'), which could result in a 200% load. The soft limit is set to</span></span>
<span><span class="co">#&gt; 100%. Overusing the CPUs has negative impact on the current R process, but also</span></span>
<span><span class="co">#&gt; on all other processes of yours and others running on the same machine. See</span></span>
<span><span class="co">#&gt; help("parallelly.options", package = "parallelly") for how to override the soft</span></span>
<span><span class="co">#&gt; and hard limits</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  We now start the calculations. There will be 3 steps.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Step 1 for grid search...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Step 2 for grid search...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Step 3 for grid search...</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8,200 × 6</span></span></span>
<span><span class="co">#&gt;     rate strength direction       error pattern         n</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     0     0.05 100% Down        286. contingency  <span style="text-decoration: underline;">1</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     0     0.05 75% Down-25% Up  292. contingency  <span style="text-decoration: underline;">1</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     0     0.05 50% Down-50% Up  286. contingency  <span style="text-decoration: underline;">1</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     0     0.05 25% Down-75% Up  284. contingency  <span style="text-decoration: underline;">1</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     0     0.05 100% Up          292. contingency  <span style="text-decoration: underline;">1</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     0     0.1  100% Down        286. contingency  <span style="text-decoration: underline;">1</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     0     0.1  75% Down-25% Up  292. contingency  <span style="text-decoration: underline;">1</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     0     0.1  50% Down-50% Up  286. contingency  <span style="text-decoration: underline;">1</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     0     0.1  25% Down-75% Up  285. contingency  <span style="text-decoration: underline;">1</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     0     0.1  100% Up          292. contingency  <span style="text-decoration: underline;">1</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 8,190 more rows</span></span></span></code></pre></div>
<p>The <code>gridSearch</code> function gives us a tibble of 8,200 rows
and 6 columns:</p>
<ul>
<li>
<code>rate</code> represents 41 values of % changing in the
DGP,</li>
<li>
<code>strength</code> represents 40 values of SD change,</li>
<li>
<code>direction</code> represents 5 conditions of mixing positive
and negative changers,</li>
<li>
<code>error</code> is the predicted error score (the distance
between the simulated dataset and the observed dataset, with smoothing
procedures above applied),</li>
<li>
<code>pattern</code> represents the calculation method (see
below),</li>
<li>
<code>n</code> shows the unique number of individuals from the
empirical dataset.</li>
</ul>
</div>
<div class="section level3">
<h3 id="evaluating-the-potential-dgps">Evaluating the Potential DGPs<a class="anchor" aria-label="anchor" href="#evaluating-the-potential-dgps"></a>
</h3>
<p>Let’s look at the error scores that minimize the distance:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grid</span> <span class="op">|&gt;</span> <span class="fu">arrange</span><span class="op">(</span><span class="va">error</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8,200 × 6</span></span></span>
<span><span class="co">#&gt;     rate strength direction error pattern         n</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 0.525     1.05 100% Up    68.0 contingency  <span style="text-decoration: underline;">1</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 0.55      1.05 100% Up    68.7 contingency  <span style="text-decoration: underline;">1</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 0.55      1    100% Up    68.8 contingency  <span style="text-decoration: underline;">1</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 0.5       1.1  100% Up    69.2 contingency  <span style="text-decoration: underline;">1</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 0.525     1.1  100% Up    69.3 contingency  <span style="text-decoration: underline;">1</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 0.5       1.05 100% Up    69.4 contingency  <span style="text-decoration: underline;">1</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 0.525     1    100% Up    69.5 contingency  <span style="text-decoration: underline;">1</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 0.575     1    100% Up    69.8 contingency  <span style="text-decoration: underline;">1</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 0.575     1.05 100% Up    71.3 contingency  <span style="text-decoration: underline;">1</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 0.5       1.15 100% Up    71.3 contingency  <span style="text-decoration: underline;">1</span>000</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 8,190 more rows</span></span></span></code></pre></div>
<p>Remember that our initial dataframe featured 50% of the sample
changing 1 SD in a positive direction. We see that the smallest error
terms are very close to these values.</p>
<p>We can visually see the best terms using <code>gridPlot</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gridPlot.html">gridPlot</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span></span></code></pre></div>
<p><img src="usage_files/figure-html/unnamed-chunk-9-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>The plot shows the best values that approximate to the data at 1%, 5%
and 10% quantiles.</p>
</div>
</div>
<div class="section level2">
<h2 id="extensions">Extensions<a class="anchor" aria-label="anchor" href="#extensions"></a>
</h2>
<div class="section level3">
<h3 id="an-alternative-comparison">An Alternative Comparison<a class="anchor" aria-label="anchor" href="#an-alternative-comparison"></a>
</h3>
<p>It is plausible that when <code>t</code> is sufficiently large, the
use of contingency tables might be problematic, as we may want to impose
some constraints to the observed responses if we do not want to take
each survey response <em>too seriously</em>. <code>gridSearch</code>
function has a <code>pattern</code> argument that takes
<code>slopes</code> instead of <code>patterns</code> as its response. We
showed the examples using the contingency table approach above, but we
propose an alternative, too.</p>
<p>In this approach, people can use the <code>slopes</code> option,
which estimates logistic regressions at the individual level—effectively
fitting varying individual fixed effects models—and calculates the model
predicted difference between units’ first response and last response.
This gives us an approximation as to how much individuals changed over
time, on average.</p>
<p>These slopes are represented for each individual in the
dataframe:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span><span class="op">$</span><span class="va">slopes</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,000 × 2</span></span></span>
<span><span class="co">#&gt;      pid estimate</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1        0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2        0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3        0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     4        0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     5        0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     6        1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     7       -<span style="color: #BB0000;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     8        0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     9        1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    10        1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 990 more rows</span></span></span></code></pre></div>
<p>The procedure is exactly the same, with the exception that rather
than calculating summed differences across contingency tables, the
algorithm now calculates a Kilmogorov-Smirnov statistic using the
observed distribution of slopes and the simulated distribution of
slopes.</p>
</div>
<div class="section level3">
<h3 id="the-detection-of-changers">The Detection of Changers<a class="anchor" aria-label="anchor" href="#the-detection-of-changers"></a>
</h3>
<p>Suppose that we settled on a DGP—let’s say, 50% of the people
changing 1 SD in the positive direction. How much can we confident to
pin down <em>specific</em> individuals in the dataset?</p>
<p><code>simulateChangers</code> function allows us to know the answer
to that question.</p>
<p>The procedure is simple: feed the DGP into the function—just like the
<code>buildDGP</code> function—and it will generate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
simulated datasets, use the varying slope procedure described above, and
compare whether a specific individual who is known to be a changer from
the simulation procedure can be detected using the individual fixed
effects, conditional on the <code>strength</code> parameter specified
before.</p>
<p>Let us see our example.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulateChangers.html">simulateChangers</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  t <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  rate <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  balance_dir <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  balance_res <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  strength <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  reliable <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  nrep <span class="op">=</span> <span class="fl">500</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in checkNumberOfLocalWorkers(workers): Careful, you are setting up 8</span></span>
<span><span class="co">#&gt; localhost parallel workers with only 4 CPU cores available for this R process</span></span>
<span><span class="co">#&gt; (per 'system'), which could result in a 200% load. The soft limit is set to</span></span>
<span><span class="co">#&gt; 100%. Overusing the CPUs has negative impact on the current R process, but also</span></span>
<span><span class="co">#&gt; on all other processes of yours and others running on the same machine. See</span></span>
<span><span class="co">#&gt; help("parallelly.options", package = "parallelly") for how to override the soft</span></span>
<span><span class="co">#&gt; and hard limits</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 500 × 4</span></span></span>
<span><span class="co">#&gt;     sims  kappa sensitivity specificity</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1 0.113        0.321       0.792</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2 0.054<span style="text-decoration: underline;">7</span>       0.282       0.771</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3 0.189        0.388       0.802</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     4 0.147        0.355       0.792</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     5 0.141        0.367       0.774</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     6 0.154        0.370       0.785</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     7 0.102        0.331       0.773</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     8 0.128        0.330       0.793</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     9 0.173        0.395       0.783</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    10 0.174        0.400       0.775</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 490 more rows</span></span></span></code></pre></div>
<p>As can be seen, <code>simulateChangers</code> spits out three
values:</p>
<ul>
<li>a <code>sensitivity</code> measure, the ability to identify true
changers;</li>
<li>a <code>specificity</code> measure, the ability to identify true
non-changers, and</li>
<li>a <code>kappa</code> score, a weighted summary of the two
measures.</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    sensitivity_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sensitivity</span><span class="op">)</span>,</span>
<span>    specificity_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">specificity</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 2</span></span></span>
<span><span class="co">#&gt;   sensitivity_mean specificity_mean</span></span>
<span><span class="co">#&gt;              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>            0.356            0.784</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="warnings-and-notes">Warnings and Notes<a class="anchor" aria-label="anchor" href="#warnings-and-notes"></a>
</h2>
<p>We would like to flag a few issues that you need to be aware of:</p>
<ul>
<li>Currently, <code>gridsearch</code> only accomodates binary outcomes.
We are hoping to generalize these procedures to cases where we have more
than 2 response categories.</li>
<li>While the <code>slopes</code> method in the <code>gridSearch</code>
function may be helpful in longer panels, we note that it is
computationally heavy as it calculates individual slopes for each
individual.</li>
<li>All functions rely heavily on parallelization, with an argument
<code>workers</code> that allows you to control the number of parallel
workers the functions will use. We strongly suggest that the
calculations are parallelized; otherwise the wait times can be
long.</li>
</ul>
<p>For more details about the protocol, please see the article, <em>The
Promises and Pitfalls of Using Panel Data to Understand Individual
Belief Change</em>, stored in <a href="https://osf.io/preprints/socarxiv/rhf4q" class="external-link">SocArXiv</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Turgut Keskintürk, Stephen Vaisey.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
